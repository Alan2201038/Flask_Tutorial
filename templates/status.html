<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Blank Page - Brand</title>
    <link rel="stylesheet" href="static/assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&amp;display=swap">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="/static/assets/css/temp.css">
</head>

<body id="page-top">
    <div id="wrapper">
        <nav class="navbar navbar-dark align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0">
            <div class="container-fluid d-flex flex-column p-0"><a
                    class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0" href="/">
                    <div class="sidebar-brand-icon rotate-n-15"><i class="fas fa-laugh-wink"></i></div>
                    <div class="sidebar-brand-text mx-3"><span>SMART TRASH</span></div>
                </a>
                <hr class="sidebar-divider my-0">
                <ul class="navbar-nav text-light" id="accordionSidebar">
                    <li class="nav-item"><a class="nav-link" href="/"><i class="fas fa-tachometer-alt"
                                style="font-size: 24px;"></i><span>Dashboard</span></a></li>
                    <li class="nav-item"><a class="nav-link" href="camera"><svg xmlns="http://www.w3.org/2000/svg"
                                width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16"
                                class="bi bi-camera-fill"
                                style="font-size: 23px;width: 27px;height: 24px;margin-bottom: 0px;margin-right: 4px;">
                                <path d="M10.5 8.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z"></path>
                                <path
                                    d="M2 4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-1.172a2 2 0 0 1-1.414-.586l-.828-.828A2 2 0 0 0 9.172 2H6.828a2 2 0 0 0-1.414.586l-.828.828A2 2 0 0 1 3.172 4H2zm.5 2a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm9 2.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0z">
                                </path>
                            </svg><span>&nbsp;Camera</span></a></li>
                    <li class="nav-item"><a class="nav-link" href="trash"><svg xmlns="http://www.w3.org/2000/svg"
                                width="1em" height="1em" fill="currentColor" viewBox="0 0 16 16" class="bi bi-trash"
                                style="font-size: 26px;width: 27px;height: 24px;margin-right: 4px;">
                                <path
                                    d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z">
                                </path>
                                <path
                                    d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z">
                                </path>
                            </svg><span>Trash Levels</span></a></li>
                    <li class="nav-item"><a class="nav-link active" href="status"><svg
                                xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 20 20"
                                fill="none" style="width: 27px;height: 24px;margin-right: 4px;">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M5.05025 3.63579C5.44078 4.02631 5.44078 4.65948 5.05025 5.05C2.31658 7.78367 2.31658 12.2158 5.05025 14.9495C5.44078 15.34 5.44078 15.9732 5.05025 16.3637C4.65973 16.7542 4.02656 16.7542 3.63604 16.3637C0.12132 12.849 0.12132 7.15051 3.63604 3.63579C4.02656 3.24526 4.65973 3.24526 5.05025 3.63579ZM14.9498 3.63602C15.3403 3.2455 15.9735 3.2455 16.364 3.63602C19.8787 7.15074 19.8787 12.8492 16.364 16.3639C15.9735 16.7545 15.3403 16.7545 14.9498 16.3639C14.5592 15.9734 14.5592 15.3403 14.9498 14.9497C17.6834 12.2161 17.6834 7.78391 14.9498 5.05023C14.5592 4.65971 14.5592 4.02655 14.9498 3.63602ZM7.87869 6.46422C8.26921 6.85474 8.26921 7.48791 7.87869 7.87843C6.70711 9.05 6.70711 10.9495 7.87869 12.1211C8.26921 12.5116 8.26921 13.1448 7.87868 13.5353C7.48816 13.9258 6.855 13.9258 6.46447 13.5353C4.51185 11.5827 4.51185 8.41684 6.46447 6.46422C6.855 6.07369 7.48816 6.07369 7.87869 6.46422ZM12.1213 6.46445C12.5119 6.07392 13.145 6.07392 13.5355 6.46445C15.4882 8.41707 15.4882 11.5829 13.5355 13.5355C13.145 13.926 12.5119 13.926 12.1213 13.5355C11.7308 13.145 11.7308 12.5118 12.1213 12.1213C13.2929 10.9497 13.2929 9.05023 12.1213 7.87866C11.7308 7.48814 11.7308 6.85497 12.1213 6.46445ZM10 8.99998C10.5523 8.99998 11 9.4477 11 9.99998V10.01C11 10.5623 10.5523 11.01 10 11.01C9.44772 11.01 9 10.5623 9 10.01V9.99998C9 9.4477 9.44772 8.99998 10 8.99998Z"
                                    fill="currentColor"></path>
                            </svg><span>IoT Status</span></a></li>
                </ul>
                <div class="text-center d-none d-md-inline"><button class="btn rounded-circle border-0"
                        id="sidebarToggle" type="button"></button></div>
            </div>
        </nav>
        <div class="d-flex flex-column" id="content-wrapper">
            <div id="content" style="border-radius: 1px;">
                <nav class="navbar navbar-light navbar-expand bg-white shadow mb-4 topbar static-top">
                    <div class="container-fluid">
                        <h1>Status</h1>
                    </div>
                </nav>
                <div class="container-fluid">

                    <div class="row">
                        <div class="col"
                            style="position: relative;display: flex;overflow: visible;margin-bottom: 20px;">
                            <img src="static/assets/img/avatars/avatar1.jpeg"
                                style="width: 100px;height: 100px;border-radius: 50px;position: relative;display: flex;"
                                width="100" height="100">
                        </div>
                        <div class="col" style="margin-right: 25px;">
                            <h1 style="font-size: 28px;">Central Hub PI</h1>
                            <p>Status: <span class="status" id="status-alan"></span></p>
                            <p>Temperature: <span class="temp" id="alan-temp"></span> <span id="tempIcon"></span></p>
                        </div>

                        <div class="row">
                            <div class="col"
                                style="position: relative;display: flex;overflow: visible;margin-bottom: 20px;">
                                <img src="static/assets/img/avatars/avatar1.jpeg"
                                    style="width: 100px;height: 100px;border-radius: 50px;position: relative;display: flex;"
                                    width="100" height="100">
                            </div>
                            <div class="col">
                                <h1 style="font-size: 28px;">Trash Detector PI</h1>
                                <p>Status: <span class="status" id="status-munir"></span></p>
                                <p>Temperature: <span class="temp" id="munir-temp"></span> <span id="tempIcon"></span>
                                </p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col"
                                style="position: relative;display: flex;overflow: visible;margin-bottom: 20px;">
                                <img src="static/assets/img/avatars/avatar1.jpeg"
                                    style="width: 100px;height: 100px;border-radius: 50px;position: relative;display: flex;"
                                    width="100" height="100">
                            </div>
                            <div class="col">
                                <h1 style="font-size: 28px;">Servo Motors PI #1</h1>
                                <p>Status: <span class="status" id="status-jj"></span></p>
                                <p>Temperature: <span class="temp" id="jj-temp"></span> <span id="tempIcon"></span></p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col"
                                style="position: relative;display: flex;overflow: visible;margin-bottom: 20px;">
                                <img src="static/assets/img/avatars/avatar1.jpeg"
                                    style="width: 100px;height: 100px;border-radius: 50px;position: relative;display: flex;"
                                    width="100" height="100">
                            </div>
                            <div class="col" style="margin-right: 5px;">
                                <h1 style="font-size: 28px;">Servo Motors PI #2</h1>
                                <p>Status: <span class="status" id="status-nick"></span></p>
                                <p>Temperature: <span class="temp" id="nick-temp"></span> <span id="tempIcon"></span>
                                </p>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col"
                                style="position: relative;display: flex;overflow: visible;margin-bottom: 20px;">
                                <img src="static/assets/img/avatars/avatar1.jpeg"
                                    style="width: 100px;height: 100px;border-radius: 50px;position: relative;display: flex;"
                                    width="100" height="100">
                            </div>
                            <div class="col">
                                <h1 style="font-size: 28px;">Camera PI</h1>
                                <p>Status: <span class="status" id="status-travis"></span></p>
                                <p>Temperature: <span class="temp" id="travis-temp"></span> <span id="tempIcon"></span>
                                </p>
                            </div>
                        </div>

                    </div>
                </div>
                <footer class="bg-white sticky-footer">
                    <div class="container my-auto">
                        <div class="text-center my-auto copyright"><span>Copyright © Brand 2023</span></div>
                    </div>
                </footer>
            </div><a class="border rounded d-inline scroll-to-top" href="#page-top"><i class="fas fa-angle-up"></i></a>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="static/assets/js/theme.js"></script>
        <script src="https://cdn.socket.io/4.1.2/socket.io.js"></script>
        <script>
            // Connect to the Socket.IO server
            var socket = io();

            // Initiallizing all variables
            var statusAlan = document.getElementById('status-alan');
            var tempAlan = document.getElementById('alan-temp');
            var timeoutIdAlan;

            var statusMunir = document.getElementById('status-munir');
            var tempMunir = document.getElementById('munir-temp');
            var timeoutMunir;

            var statusjj = document.getElementById('status-jj');
            var tempjj = document.getElementById('jj-temp');
            var timeoutjj;

            var statusNick = document.getElementById('status-nick');
            var tempNick = document.getElementById('nick-temp');
            var timeoutNick;

            var statusTravis = document.getElementById('status-travis');
            var tempTravis = document.getElementById('travis-temp');
            var timeoutTravis;

            var timeoutDuration = 10000; // Adjust the duration as needed (in milliseconds)
            var timeoutId;

            socket.on('connect', function () {
                console.log('Connected to server');

                // Set starting status.
                setOfflineStatus(statusMunir);
                setOfflineStatus(statusjj);
                setOfflineStatus(statusNick);
                setOfflineStatus(statusTravis);
            });

            // Receive temperature updates
            socket.on('update', function (data) {
                var topic = data.topic;
                var tempLevel = parseFloat(data.payload);
                setTempLevel(topic, tempLevel);

            });

            function setTempLevel(topic, temperature) {
                var indicator;
                var timeoutId;
                var statusElement;

                if (topic === 'temp/alan') {
                    indicator = tempAlan;
                    setOnlineStatus(statusAlan)
                } else if (topic === 'temp/munir') {
                    indicator = tempMunir;
                    timeoutId = timeoutMunir;
                    statusElement = statusMunir;
                    setOnlineStatus(statusMunir);
                } else if (topic === 'temp/jj') {
                    indicator = tempjj;
                    timeoutId = timeoutjj;
                    statusElement = statusjj;
                    setOnlineStatus(statusjj);
                } else if (topic === 'temp/nick') {
                    indicator = tempNick;
                    timeoutId = timeoutNick;
                    statusElement = statusNick;
                    setOnlineStatus(statusNick);
                } else if (topic === 'temp/travis') {
                    indicator = tempTravis;
                    timeoutId = timeoutTravis;
                    statusElement = statusTravis;
                    setOnlineStatus(statusTravis);
                }

                if (indicator) {
                    indicator.textContent = temperature + "°C";

                    indicator.className = "temp"; // Reset the class

                    var tempIcon = document.getElementById("tempIcon");
                    tempIcon.innerHTML = ""; // Clear the previous icon

                    if (temperature < 45) {
                        indicator.classList.add("temp-low");
                    } else if (temperature >= 45 && temperature < 55) {
                        indicator.classList.add("temp-medium");
                    } else {
                        indicator.classList.add("temp-high");
                        tempIcon.innerHTML = '<i class="fas fa-exclamation-circle"></i>';
                    }

                }
            }

            function clearText(document) {
                document.textContent = " ";
            }

            // Reset the timeout for topic 'temp/alan'
            function resetTimeoutAlan() {
                clearTimeout(timeoutIdAlan);
                timeoutIdAlan = setTimeout(function () {
                    setOfflineStatus(statusAlan);
                    clearText(tempAlan);
                }, timeoutDurationAlan);
            }

            // Reset the timeout for topic 'temp/munir'
            function resetTimeoutMunir() {
                clearTimeout(timeoutIdMunir);
                timeoutIdMunir = setTimeout(function () {
                    setOfflineStatus(statusMunir);
                    clearText(tempMunir);
                }, timeoutDurationMunir);
            }


            function setOfflineStatus(document) {
                document.className = "status";
                document.classList.add("offline");
                document.textContent = 'Offline';
            }

            function setOnlineStatus(document) {
                document.className = "status";
                document.classList.add("online");
                document.textContent = 'Online';
            }

        </script>
</body>

</html>